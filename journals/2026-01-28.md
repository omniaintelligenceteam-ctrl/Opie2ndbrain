# Daily Notes: 2026-01-28

## Omnia Lighting Feature - Major Development Session

### What We Built
**Smart Grid Placement System** for the Omnia Light Scape Pro mockup generator:

1. **14x14 Grid Overlay** - User clicks grid cells to place fixtures
   - Left click = add fixture
   - Right click = remove
   - Color-coded by fixture type (amber=uplight, green=path, blue=down, etc.)
   - Glow effect on cells with fixtures

2. **Fixture Type Selector** - Small emoji buttons to pick type before placing:
   - ‚¨ÜÔ∏è Up Light, üö∂ Path, ‚¨áÔ∏è Down, üî¶ Spot, ‚ö´ Well, üß± Wall

3. **Generation Integration** - Grid positions converted to descriptive prompts:
   - "LEFT side, UPPER-MIDDLE (grid 3,2 ‚âà 18% from left, 18% from top)"
   - AI places fixtures at specified grid positions

### Design Evolution
- Started with AI zone detection (Gemini analyzing image for features)
- Wes wanted simpler approach ‚Üí switched to 14x14 fixed grid
- Grid gives user precise control, AI picks exact spot within cell

### Key Files Changed
- `App.tsx` - Grid UI, placement mode toggle, zone fixtures state
- `services/geminiService.ts` - Added `detectLightingZones()` function (not used in final grid approach)

### Build Issues Fixed
Multiple TypeScript errors blocking Vercel deployment:
- `LightingStyleIntegration.tsx` - Fixed hook return type mismatches
- `geminiService.ts` - Beam angle type casting
- `replicateService.ts` - Env var type casting

### Current Status
- Toggle "AI Placement" / "Grid Placement" should show above image upload
- Wes testing on Vercel - may need hard refresh to see changes
- Latest commit: `25603e9`

### Research Completed
`memory/agent-research/lighting-mockup-deep-dive.md` - Comprehensive research on:
- Prompt engineering for Gemini image gen
- Grid/zone placement approaches
- Compositing method (recommended for precise control)
- IC-Light and relighting models
- React canvas architecture patterns

### Key Insight from Research
**Compositing approach** (generate dark scene, overlay light effects after) gives most precise fixture placement control vs trying to get AI to place lights exactly.

## Other Notes
- Wes accessing Clawdbot on Digital Ocean droplet
- `clawdbot dashboard` command to access Control UI

## Active Threads
- [ ] Grid placement toggle not showing for Wes - may be browser cache issue
- [ ] Test grid placement once visible
- [ ] Consider compositing approach for V2 (more precise light placement)

## Commits Today (Omnia)
- `15f29b8` - Smart zone-based fixture placement
- `0e9fb51` - 14x14 grid placement system
- `bf1bd71` - TS error fixes
- `25603e9` - Make toggle more visible
